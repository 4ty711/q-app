<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="description" content="Description">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="icon" type="image/png" href="puzzle-invert.png">
    <title>Q</title>
    <meta name="description" content="">
    <meta name="keywords" content="dabstract, programming">
    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet">
    <link rel="stylesheet" href="leto.min.css" />
    <link href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/kju-org/kju-client@latest/index.js"></script>
    <script src="https://unpkg.com/@isomorphic-git/lightning-fs"></script>
    <script type="module">
        window.fs = new LightningFS('fs');
    import http from 'https://unpkg.com/isomorphic-git@beta/http/web/index.js';
    window.http = http;
    
    </script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <style>
        html,
    body {
        height: 100%;
    }

    ::-webkit-input-placeholder { /* Edge */
      color: #2a2a2a;
    }

    :-ms-input-placeholder { /* Internet Explorer 10-11 */
      color: #2a2a2a;
    }

    ::placeholder {
      color: #2a2a2a;
    }
    </style>
</head>

<body>
    <div class="leto-frame-dark leto-group leto-horizontal-center leto-vertical-top" id="app" style="height:100%">
        <div class="leto-group leto-width-four-fifths leto-mt-xxl">
            <div class="leto-width-two-thirds leto-column leto-width-full leto-group leto-vertical-top leto-pr">
                <div class="leto-bg-light-grey leto-display-block leto-width-full leto-p leto-mt-sm leto-mb-lg leto-text-darker-grey" v-bind:class="{'leto-roundness-lg': newMessageShown, 'leto-roundness-full': !newMessageShown}">
                    <div v-if="!newMessageShown" class="leto-click" v-on:click="newMessageShown=true;">
                        <b>+</b> New message...
                    </div>
                    <div v-else>
                        <textarea class="leto-input leto-bg-none leto-ml-sm leto-border-none leto-text-lg leto-text-black leto-width-full" style="color:#111111;font-family:Arial;" id="contentInput" v-model="newMessage.content" placeholder="Content...">
                        </textarea>
                        <br>
                        <div class="leto-button-sm leto-border-darker-grey leto-text-black" v-for="response in newMessage.responses">{{response.title}} <i class="fa fa-times leto-pl-xxs" v-on:click="removeResponseFromNewMessage(response.title)"></i></div>
                        <input type="text" class="leto-roundness-full leto-width-xl leto-text-md leto-ph-sm leto-pv-xs leto-bg-none leto-border-none" placeholder="+ Add a response &#8629;" v-model="newMessageResponse" v-on:keyup.enter="addRecieverToNewMessage($event)" v-on:keyup.delete="popResponseFromNewMessage($event)"> <span v-if="newMessageResponse">hit enter</span>
                        <br>
                        <br>
                        <input type="text" class="leto-roundness-full leto-width-xl leto-text-md leto-ph-sm leto-pv-xs leto-bg-none leto-border-none" placeholder="+ Reciever" v-model="newMessage.reciever">
                        <div class="leto-bubble-sm leto-border-black" style="float:right;" v-on:click="newMessageShown=false">
                            <i class="fa fa-times leto-text-black"></i>
                        </div>
                        <div class="leto-bubble-sm leto-border-black" style="float:right;" v-on:click="createMessage(newMessage)">
                            <i class="fa fa-paper-plane leto-text-black"></i>
                        </div>
                    </div>
                </div>
                <div class="leto-mb-lg leto-group" v-for="message in messages" v-bind:class="{'leto-right leto-row-reverse leto-pr': message.mine}">
                    <div class="leto-bubble-sm">
                        {{message.senderShort}}
                    </div>
                    <div class="leto-group leto-column">
                        <div class="leto-text-lg leto-ml-sm leto-mv-xs leto-right leto-ph-sm">{{message.content}}</div>
                        <div class="leto-display-block" v-bind:class="{'leto-right': message.mine}">
                            <div class="leto-button-sm" v-for="response in message.responses">{{response.title}}</div>
                        </div>
                        <div class="leto-m-xs leto-right leto-text-grey leto-ph-xs" v-if="message.mine">
                            <span class="leto-click" v-on:click="deleteMessage(message._id)">delete</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="leto-width-third">
                <div class="leto-card leto-p-sm leto-bg-black leto-text-white leto-width-full leto-bg-black-dm">
                    <div class="leto-group leto-row ">
                        <!--div class="leto-bubble-wrapper-xl leto-click">
                            <div class="leto-bubble-md" v-on:click="newMessageShown=true" v-if="!newMessageShown"><i class="fa fa-plus"></i></div>
                            <div class="leto-bubble-md" v-on:click="newMessageShown=false" v-if="newMessageShown"><i class="fa fa-minus"></i></div>
                            <label>New msg</label>
                        </div-->
                        <!--div class="leto-bubble-wrapper">
                            <div class="leto-bubble"><i class="fa fa-search"></i></div>
                            <label>Search</label>
                        </div-->
                        <div class="leto-bubble-wrapper-xl">
                            <div class="leto-bubble-md leto-click" v-bind:class="{'leto-border-green': creationToken}" v-on:click="createToken()"><i class="fa fa-key"></i></div>
                            <label><span v-if="creationToken">Token: ok</span><span v-else>Get a token</span></label>
                        </div>
                        <div class="leto-bubble-wrapper-xl" v-if="me">
                            <div class="leto-bubble-md leto-click" v-on:click="showMe=!showMe"><i class="fa fa-user"></i></div>
                            <label>{{me}}</label>
                        </div>
                    </div>
                    <div v-if="showCreationToken">
                        <div class="leto-m-xxs"><input type="text" class="leto-width-full leto-bg-none leto-input leto-text-white leto-text-md" v-model="creationToken"></div>
                        <div class="leto-button-xxs" v-on:click="saveCreationToken(creationToken)">save</div>
                        <div class="leto-button-xxs" v-on:click="deleteCreationToken()">delete</div>
                        <div class="leto-button-xxs" v-on:click="showCreationToken=false">close</div>
                    </div>
                    <div v-if="showMe">
                        <div class="leto-m-sm">
                            Yiu are identified by: {{me}}
                        </div>
                        <!--div class="leto-button-xxs" v-on:click="showMe=false">resend my token</div-->
                        <div class="leto-button-xxs" v-on:click="setMe()">set email</div>
                        <div class="leto-button-xxs" v-on:click="deleteMe()">delete</div>
                        <div class="leto-button-xxs" v-on:click="showMe=false">close</div>
                    </div>
                    <!--div>
                        <div class="leto-badge"><i class="fa fa-moon"></i></div>
                    </div-->
                </div>
                <div class="leto-p-xs">
                    <!--div class="leto-group leto-width-full leto-horizontal-left leto-mb">
                        <div class="leto-badge" v-for="tag in tags"><i class="fa fa-circle leto-text-grey leto-pr-xs"></i> {{tag}}</div>
                    </div-->
                    <!--div class="leto-bubble-wrapper-sm leto-mr-sm" v-for="participant in participants">
                        <div class="leto-bubble">{{participant.short}}</div>
                        <label class="leto-text-sm">{{participant.name.substring(0,5)}}...</label>
                    </div-->
                </div>
            </div>
        </div>
    </div>
    <script src="index.js"></script>
</body>

</html>